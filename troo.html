<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Swagger UI</title>
    <link rel="stylesheet" type="text/css" href="./swagger-ui.css" />
    <script src="./swagger-ui-bundle.js" charset="UTF-8"></script>
    <script src="./swagger-ui-standalone-preset.js" charset="UTF-8"></script>
</head>
<body>
    <div id="swagger-ui"></div>
    <script>
        window.onload = function () {
            // Function to get the URL parameter value
            function getUrlParameter(name) {
                const urlParams = new URLSearchParams(window.location.search);
                return urlParams.get(name);
            }

            // Retrieve the resolveUrl parameter
            const customUrl = getUrlParameter('resolveUrl');

            // Function to resolve URLs
            function resolveUrl(url) {
                const anchor = document.createElement('a');
                anchor.href = url;
                return anchor.href;
            }

            // Use the custom URL or fallback to a default URL
            const resolvedUrl = resolveUrl(customUrl || './default-url');

            // Function to fetch and build Swagger UI
            function resolveConfig(cb) {
                return fetch(resolvedUrl)
                    .then(res => res.json())
                    .then((config) => {
                        const resConfig = {
                            dom_id: '#swagger-ui',
                            deepLinking: true,
                            presets: [
                                SwaggerUIBundle.presets.apis,
                                SwaggerUIStandalonePreset
                            ],
                            plugins: [
                                SwaggerUIBundle.plugins.DownloadUrl
                            ],
                            layout: "StandaloneLayout",
                            ...config,
                        };
                        return cb(resConfig);
                    });
            }

            const buildUi = function (config) {
                const ui = SwaggerUIBundle(config);
                window.ui = ui;
            };

            // Call resolveConfig to build Swagger UI
            resolveConfig(buildUi);
        }
    </script>
</body>
</html>